<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Alvance Jersey – E-Commerce</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#f6f8f9; --card:#ffffff; --text:#1d2433; --muted:#667085; --brand:#0ea5e9; --brand-2:#22c55e; --brand-3:#f59e0b; --line:#e5e7eb;
      --shadow:0 10px 30px rgba(2,6,23,.08);
    }
    body.dark{
      --bg:#0b1220; --card:#0f172a; --text:#e5e7eb; --muted:#94a3b8; --brand:#38bdf8; --brand-2:#34d399; --brand-3:#fbbf24; --line:#1f2937;
      --shadow:0 10px 30px rgba(0,0,0,.4);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:Poppins, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;background:var(--bg);color:var(--text);}
    a{color:inherit;text-decoration:none}
    img{max-width:100%;display:block}
    .container{width:min(1150px,92%);margin-inline:auto;padding-left:6px;padding-right:6px}

    /* Header */
    header{position:sticky;top:0;z-index:50;background:rgba(255,255,255,.6);backdrop-filter:blur(10px);border-bottom:1px solid var(--line)}
    body.dark header{background:rgba(15,23,42,.6)}
    .nav{display:flex;align-items:center;justify-content:space-between;padding:12px 0}
    .brand{display:flex;gap:10px;align-items:center;font-weight:700}
    .brand .logo{width:36px;height:36px;border-radius:10px;background:linear-gradient(135deg,var(--brand),var(--brand-2));box-shadow:var(--shadow);display:grid;place-items:center;color:#fff}
    .nav-links{display:flex;gap:18px;align-items:center}
    .nav-links a{padding:8px 10px;border-radius:10px}
    .nav-links a:hover{background:rgba(2,6,23,.06)}
    body.dark .nav-links a:hover{background:rgba(255,255,255,.06)}
    .btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:12px;border:1px solid var(--line);background:var(--card);box-shadow:var(--shadow);cursor:pointer;font-weight:600}
    .btn.primary{border-color:transparent;background:linear-gradient(135deg,var(--brand),var(--brand-2));color:#fff}
    .btn.ghost{background:transparent;box-shadow:none}
    .icon{font-style:normal}

    /* Hero */
    .hero{position:relative;isolation:isolate;overflow:hidden}
    .hero::before{content:"";position:absolute;inset:-10% -20%;background:radial-gradient(1200px 500px at 20% 20%,rgba(14,165,233,.25),transparent 60%),radial-gradient(900px 400px at 80% 10%,rgba(34,197,94,.18),transparent 60%),radial-gradient(900px 450px at 50% 100%,rgba(245,158,11,.18),transparent 60%);z-index:-1;transform:translateY(var(--py,0px));transition:transform .2s}
    .hero-wrap{display:grid;grid-template-columns:1.2fr .8fr;gap:40px;align-items:center;padding:42px 0 64px}
    .hero h1{font-size:clamp(28px,4vw,46px);line-height:1.1;margin:0 0 10px}
    .hero p{color:var(--muted);margin:0 0 20px}
    .badges{display:flex;flex-wrap:wrap;gap:10px;margin-top:8px}
    .badge{padding:6px 10px;border-radius:999px;border:1px dashed var(--line);font-size:12px}
    .hero-card{background:var(--card);border:1px solid var(--line);border-radius:18px;padding:18px;box-shadow:var(--shadow)}
    .hero-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    .hero-tile{position:relative;border-radius:14px;overflow:hidden;border:1px solid var(--line)}
    .hero-tile img{aspect-ratio:1.2/1;object-fit:cover}
    .hero-tile span{position:absolute;inset:auto 10px 10px 10px;background:rgba(0,0,0,.5);color:#fff;padding:6px 10px;border-radius:10px;font-size:12px}

    /* Stats */
    .stats{display:flex;gap:12px;margin-top:14px;flex-wrap:wrap}
    .stat{background:linear-gradient(180deg,rgba(255,255,255,0.85),rgba(255,255,255,0.7));padding:8px 12px;border-radius:12px;border:1px solid var(--line);display:flex;flex-direction:column;align-items:flex-start}
    body.dark .stat{background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent)}
    .stat strong{font-size:18px}
    .stat span{font-size:12px;color:var(--muted)}

    /* Controls */
    .controls{display:flex;flex-wrap:wrap;gap:10px;margin:18px 0 8px}
    .input{display:flex;align-items:center;gap:8px;padding:10px 12px;border:1px solid var(--line);border-radius:12px;background:var(--card)}
    .input input,.input select{border:none;outline:none;background:transparent;color:var(--text)}

    /* Product grid */
    .grid{display:grid;grid-template-columns:repeat(4,1fr);gap:18px}
    @media (max-width:1000px){.hero-wrap{grid-template-columns:1fr}.grid{grid-template-columns:repeat(2,1fr)}}
    @media (max-width:620px){.grid{grid-template-columns:1fr}}

    .card{background:var(--card);border:1px solid var(--line);border-radius:18px;overflow:hidden;box-shadow:var(--shadow);display:flex;flex-direction:column;opacity:0;transform:translateY(20px);animation:reveal .6s ease forwards}
    .card .thumb{position:relative;overflow:hidden}
    .card .thumb img{width:100%;aspect-ratio:1/1;object-fit:cover;transition:transform .6s}
    .card:hover .thumb img{transform:scale(1.06)}
    .chip{position:absolute;left:12px;top:12px;background:var(--card);border:1px solid var(--line);padding:6px 10px;border-radius:999px;font-size:12px;box-shadow:var(--shadow)}
    .content{padding:14px 14px 12px;display:flex;flex-direction:column;gap:8px}
    .title{font-weight:600}
    .price{font-weight:700}
    .muted{color:var(--muted);font-size:13px}
    .row{display:flex;align-items:center;justify-content:space-between;gap:8px}
    .qty{display:flex;align-items:center;gap:6px}
    .qty button{width:28px;height:28px;border-radius:8px;border:1px solid var(--line);background:var(--card);cursor:pointer}

    /* Cart sheet */
    .sheet{position:fixed;inset:0 0 0 auto;max-width:420px;transform:translateX(100%);transition:transform .35s cubic-bezier(.2,.9,.2,1);background:var(--card);border-left:1px solid var(--line);z-index:60;display:flex;flex-direction:column}
    .sheet.show{transform:translateX(0)}
    .sheet .top{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;border-bottom:1px solid var(--line)}
    .sheet .items{padding:12px 16px;flex:1;overflow:auto;display:flex;flex-direction:column;gap:12px}
    .sheet .bottom{border-top:1px solid var(--line);padding:12px 16px;display:grid;gap:10px}
    .line{display:flex;align-items:center;justify-content:space-between}

    .item{display:grid;grid-template-columns:64px 1fr auto;gap:10px;align-items:center;border:1px solid var(--line);border-radius:14px;padding:8px}
    .item img{width:64px;height:64px;object-fit:cover;border-radius:10px}
    .del{background:transparent;border:none;font-size:20px;cursor:pointer}

    /* Modal */
    .modal{position:fixed;inset:0;display:none;place-items:center;background:rgba(2,6,23,.6);z-index:70}
    .modal.show{display:grid}
    .modal .box{width:min(850px,92%);background:var(--card);border:1px solid var(--line);border-radius:18px;box-shadow:var(--shadow);overflow:hidden}
    .modal .box .body{display:grid;grid-template-columns:1fr 1fr}
    @media (max-width:820px){.modal .box .body{grid-template-columns:1fr}}
    .modal header{position:unset;background:transparent;border:none}
    .modal .banner{position:relative}
    .modal .banner img{width:100%;height:100%;object-fit:cover;aspect-ratio:4/3}
    .close{border:none;background:transparent;font-size:24px;cursor:pointer}

    /* Checkout */
    .form{display:grid;gap:10px}
    .form .field{display:grid;gap:6px}
    .form input,.form textarea,.form select{padding:10px 12px;border-radius:10px;border:1px solid var(--line);background:transparent;color:var(--text)}

    /* Toast */
    .toast{position:fixed;left:50%;bottom:24px;transform:translateX(-50%) translateY(20px);opacity:0;background:var(--card);border:1px solid var(--line);box-shadow:var(--shadow);padding:10px 14px;border-radius:12px;z-index:80;transition:.35s}
    .toast.show{opacity:1;transform:translateX(-50%) translateY(0)}

    /* Footer */
    footer{margin-top:40px;border-top:1px solid var(--line);padding:24px 0;color:var(--muted)}

    /* Animations */
    @keyframes reveal{to{opacity:1;transform:none}}
    .reveal{opacity:0;transform:translateY(16px)}
    .reveal.show{opacity:1;transform:none;transition:.6s cubic-bezier(.2,.9,.2,1)}
  </style>
</head>
<body>
  <header>
    <div class="container nav">
      <a class="brand" href="#">
        <div class="logo">AJ</div>
        <span>Alvance Jersey</span>
      </a>
      <nav class="nav-links">
        <a href="#produk">Produk</a>
        <a href="#tentang">Tentang</a>
        <a href="#kontak">Kontak</a>
        <button id="themeBtn" class="btn ghost" title="Toggle tema" aria-label="Ganti tema">🌗</button>
        <button id="cartBtn" class="btn" aria-label="Buka keranjang">🛒 <span id="cartCount">0</span></button>
      </nav>
    </div>
  </header>

  <section class="hero">
    <div class="container hero-wrap">
      <div>
        <div class="badges">
          <span class="badge">Custom & Print On-Demand</span>
          <span class="badge">Pengiriman Se-Indonesia</span>
          <span class="badge">Harga Mulai 199k</span>
        </div>
        <h1>Jersey Custom Premium untuk Tim & Komunitasmu</h1>
        <p>Desain bebas, material nyaman, finishing rapi. Order satuan atau massal, semua bisa di Alvance Jersey.</p>

        <!-- Stats: pengunjung & terjual -->
        <div class="stats" aria-hidden="false">
          <div class="stat" title="Jumlah pengunjung (lokal)">
            <strong id="visitorsCount">0</strong>
            <span>Jumlah Pengunjung (lokal)</span>
          </div>
          <div class="stat" title="Jumlah jersey terjual (lokal)">
            <strong id="soldCount">0</strong>
            <span>Jumlah Terjual Jersey</span>
          </div>
        </div>

        <div class="controls">
          <label class="input" style="flex:1">
            🔎
            <input id="search" placeholder="Cari jersey… (misal: bola, basket, esport)" />
          </label>
          <label class="input">
            ☰
            <select id="sort">
              <option value="new">Terbaru</option>
              <option value="price-asc">Harga: Termurah</option>
              <option value="price-desc">Harga: Termahal</option>
              <option value="az">Nama A→Z</option>
            </select>
          </label>
          <label class="input">
            🏷️
            <select id="filterCat">
              <option value="all">Semua Kategori</option>
              <option value="bola">Sepak Bola</option>
              <option value="basket">Basket</option>
              <option value="esport">E-Sport</option>
              <option value="running">Running</option>
            </select>
          </label>
          <button class="btn primary" onclick="document.getElementById('produk').scrollIntoView({behavior:'smooth'})">Belanja Sekarang</button>
        </div>
      </div>
      <div class="hero-card">
        <div class="hero-grid">
          <figure class="hero-tile">
            <img alt="Jersey bola" src="assets/img/jerseyfootball.jpg"/>
            <span>Jersey Bola</span>
          </figure>
          <figure class="hero-tile">
            <img alt="Jersey basket" src="assets/img/jerseybasket.jpg"/>
            <span>Jersey Basket</span>
          </figure>
          <figure class="hero-tile">
            <img alt="Jersey esport" src="assets/img/esport.jpg"/>
            <span>E-Sport Team</span>
          </figure>
          <figure class="hero-tile">
            <img alt="Running" src="assets/img/jerseyrunning.jpg"/>
            <span>Running Jersey</span>
          </figure>
        </div>
      </div>
    </div>
  </section>

  <main class="container" id="produk" style="padding:26px 0 6px">
    <div class="row" style="margin-bottom:12px">
      <h2 style="margin:0">Produk Terbaru</h2>
      <span class="muted">Pilih desain favoritmu, atur ukuran & qty.</span>
    </div>
    <div id="grid" class="grid"></div>
  </main>

  <section class="container reveal" id="tentang" style="margin-top:32px">
    <div class="row" style="align-items:flex-start;gap:20px">
      <div style="flex:1">
        <h3>Tentang Alvance Jersey</h3>
        <p class="muted">Kami adalah platform jasa desain & produksi jersey custom. Mengutamakan kualitas bahan, printing tajam, dan proses cepat. Cocok untuk tim futsal, basket, e-sport, sekolah, hingga event.</p>
        <ul class="muted">
          <li>✔️ Minimum order fleksibel, bisa satuan</li>
          <li>✔️ Desain bebas revisi hingga fix</li>
          <li>✔️ Ukuran lengkap: XS – 4XL</li>
        </ul>
      </div>
      <div class="hero-card" style="flex:1">
        <img src="assets/img/Logo.png" alt="Workshop" style="border-radius:12px"/>
      </div>
    </div>
  </section>

  <section class="container reveal" id="kontak" style="margin:36px auto 0">
    <div class="hero-card">
      <div class="row" style="justify-content:space-between">
        <div>
          <h3>Butuh bantuan order massal?</h3>
          <p class="muted">Hubungi tim kami via WhatsApp: <a href="https://wa.me/6281234567890" target="_blank" rel="noreferrer">+62 812-3456-7890</a></p>
        </div>
        <a class="btn" href="https://wa.me/6281234567890" target="_blank" rel="noreferrer">💬 Chat Sekarang</a>
      </div>
    </div>
  </section>

  <!-- Cart Sheet -->
  <aside id="cartSheet" class="sheet" aria-hidden="true" aria-label="Keranjang belanja">
    <div class="top">
      <strong>Keranjang</strong>
      <button class="close" id="closeCart" aria-label="Tutup">✕</button>
    </div>
    <div id="cartItems" class="items"></div>
    <div class="bottom">
      <div class="line"><span class="muted">Subtotal</span><strong id="subtotal">Rp 0</strong></div>
      <div class="line"><span class="muted">Ongkir (estimasi)</span><span id="ship">Rp 20.000</span></div>
      <div class="line" style="font-size:18px"><span><strong>Total</strong></span><strong id="grand">Rp 0</strong></div>
      <button id="checkoutBtn" class="btn primary">🧾 Lanjut Checkout</button>
    </div>
  </aside>

  <!-- Quick View / Detail Produk -->
  <div id="productModal" class="modal" aria-hidden="true">
    <div class="box">
      <header class="top">
        <strong id="mTitle">Detail Produk</strong>
        <button class="close" id="mClose">✕</button>
      </header>
      <div class="body">
        <div class="banner"><img id="mImg" alt="Produk"/></div>
        <div style="padding:16px;display:grid;gap:10px">
          <div class="muted" id="mCat">Kategori</div>
          <div style="display:flex;align-items:center;justify-content:space-between">
            <h3 id="mName" style="margin:0">Nama</h3>
            <strong id="mPrice">Rp 0</strong>
          </div>
          <p class="muted" id="mDesc"></p>
          <div class="field">
            <label>Ukuran</label>
            <select id="mSize">
              <option>S</option><option>M</option><option>L</option><option>XL</option><option>XXL</option>
            </select>
          </div>
          <div style="display:flex;align-items:center;gap:12px">
            <div class="qty" aria-hidden="false">
              <button id="minus">−</button>
              <span id="mQty">1</span>
              <button id="plus">+</button>
            </div>
            <button id="addBtn" class="btn primary">🛒 Tambah ke Keranjang</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Checkout Modal -->
  <div id="checkoutModal" class="modal" aria-hidden="true">
    <div class="box">
      <header class="top">
        <strong>Checkout</strong>
        <button class="close" id="checkoutClose">✕</button>
      </header>
      <div class="body" style="grid-template-columns:1.2fr .8fr">
        <form id="checkoutForm" class="form" style="padding:16px">
          <div class="field"><label>Nama Lengkap</label><input required name="name" placeholder="Nama kamu" /></div>
          <div class="field"><label>Email</label><input required type="email" name="email" placeholder="email@contoh.com" /></div>
          <div class="field"><label>No. WhatsApp</label><input required name="phone" placeholder="08xxxx" /></div>
          <div class="field"><label>Alamat</label><textarea required name="address" rows="3" placeholder="Jalan, Kel/Desa, Kec, Kota/Kab, Provinsi"></textarea></div>
          <div class="field"><label>Pengiriman</label>
            <select name="ship">
              <option value="20000">Reguler (Est 3-5 hari) – Rp20.000</option>
              <option value="35000">Cepat (Est 1-2 hari) – Rp35.000</option>
            </select>
          </div>
          <button class="btn primary" type="submit">Bayar Nanti (Demo)</button>
          <span class="muted">Ini simulasi. Tidak ada pembayaran asli.</span>
        </form>
        <div style="padding:16px;border-left:1px solid var(--line)">
          <h4>Ringkasan</h4>
          <div id="summary" class="muted"></div>
        </div>
      </div>
    </div>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite">Ditambahkan ke keranjang ✅</div>

  <footer>
    <div class="container" style="display:flex;justify-content:space-between;flex-wrap:wrap;gap:10px">
      <span>© <span id="year"></span> Alvance Jersey</span>
      <span class="muted">Dibuat oleh Rifky Ahmad</span>
    </div>
  </footer>

  <script>
    // ===== Utilities =====
    const fmt = n => new Intl.NumberFormat('id-ID').format(n)
    const $ = s => document.querySelector(s)
    const $$ = s => Array.from(document.querySelectorAll(s))

    // ===== Demo Data =====
    const PRODUCTS = [
      { id: 1, name: 'Jersey Sepak Bola', cat: 'bola', price: 229000, img: 'assets/img/jerseyfootball.jpg', desc: 'Bahan dry-fit premium, breathable, cocok untuk pertandingan dan latihan.' },
      { id: 2, name: 'Jersey Basket', cat: 'basket', price: 259000, img: 'assets/img/jerseybasket.jpg', desc: 'Ringan dan cepat kering, potongan bebas gerak untuk permainan intens.' },
      { id: 3, name: 'Jersey E-Sport', cat: 'esport', price: 279000, img: 'assets/img/esport.jpg', desc: 'Full print HD, warna tajam untuk branding tim kamu.' },
      { id: 4, name: 'Jersey Running', cat: 'running', price: 199000, img: 'assets/img/jerseyrunning.jpg', desc: 'Ultra ringan, sirkulasi udara maksimal, nyaman untuk long run.' },
      { id: 5, name: 'Jersey Sepak Bola (Gradient)', cat: 'bola', price: 249000, img: 'assets/img/jerseyfootballl.jpg', desc: 'Desain modern gradient, cocok untuk tim sekolah dan komunitas.' },
      { id: 6, name: 'Jersey Bola (Mesh)', cat: 'bola', price: 269000, img: 'assets/img/jerseybola.jpeg', desc: 'Panel mesh di area panas, mobilitas optimal.' },
      { id: 7, name: 'Jersey E-Sport (Cyber)', cat: 'esport', price: 289000, img: 'assets/img/esports2.jpeg', desc: 'Look kompetitif dengan aksen cyber, ready sponsor patch.' },
      { id: 8, name: 'Jersey Running (Quick)', cat: 'running', price: 209000, img: 'assets/img/running2.jpg', desc: 'Quick-dry dan anti-bau, nyaman dipakai harian.' }
    ];

    // ===== State =====
    let filters = { q: '', cat: 'all', sort: 'new' }
    let cart = JSON.parse(localStorage.getItem('aj_cart') || '[]')

    // ===== Persistent counters (local demo only) =====
    // visitorsCount: increments once per browser per visit session
    // soldCount: increments when checkout completes (by total qty)
    const VISITORS_KEY = 'aj_visitors'
    const SOLD_KEY = 'aj_sold'
    const VISIT_FLAG = 'aj_visited_flag' // to avoid increment multiple times rapidly

    function loadCounters(){
      const v = parseInt(localStorage.getItem(VISITORS_KEY) || '0', 10)
      const s = parseInt(localStorage.getItem(SOLD_KEY) || '0', 10)
      $('#visitorsCount').textContent = fmt(v)
      $('#soldCount').textContent = fmt(s)
    }

    function incrementVisitors(){
      // simple per-browser increment: increment only once per day (using date)
      const lastVisit = localStorage.getItem(VISIT_FLAG)
      const today = new Date().toISOString().slice(0,10)
      if(lastVisit !== today){
        const v = (parseInt(localStorage.getItem(VISITORS_KEY) || '0', 10) + 1)
        localStorage.setItem(VISITORS_KEY, String(v))
        localStorage.setItem(VISIT_FLAG, today)
      }
      loadCounters()
    }

    function incrementSold(byQty){
      const s = (parseInt(localStorage.getItem(SOLD_KEY) || '0', 10) + byQty)
      localStorage.setItem(SOLD_KEY, String(s))
      loadCounters()
    }

    // ===== Theme =====
    const themeBtn = $('#themeBtn')
    const initTheme = () => { if(localStorage.getItem('aj_theme')==='dark') document.body.classList.add('dark') }
    const toggleTheme = () => { document.body.classList.toggle('dark'); localStorage.setItem('aj_theme', document.body.classList.contains('dark')?'dark':'light') }
    themeBtn.addEventListener('click',toggleTheme)
    initTheme()

    // ===== Parallax hero =====
    const hero = document.querySelector('.hero')
    window.addEventListener('scroll',()=>{
      const y = Math.min(60, window.scrollY*.2)
      if(hero) hero.style.setProperty('--py', y+'px')
    })

    // ===== Render Products =====
    const grid = $('#grid')
    function renderProducts(){
      grid.innerHTML = ''
      let data = [...PRODUCTS]
      if(filters.q){
        const q = filters.q.toLowerCase()
        data = data.filter(p=>p.name.toLowerCase().includes(q)||p.cat.includes(q))
      }
      if(filters.cat!=='all') data = data.filter(p=>p.cat===filters.cat)
      if(filters.sort==='price-asc') data.sort((a,b)=>a.price-b.price)
      if(filters.sort==='price-desc') data.sort((a,b)=>b.price-a.price)
      if(filters.sort==='az') data.sort((a,b)=>a.name.localeCompare(b.name))
      // 'new' keep original order

      data.forEach((p,i)=>{
        const el = document.createElement('article')
        el.className = 'card'
        el.style.animationDelay = (i*60)+'ms'
        el.innerHTML = `
          <div class="thumb">
            <img src="${p.img}" alt="${p.name}">
            <span class="chip">${p.cat.toUpperCase()}</span>
          </div>
          <div class="content">
            <div class="title">${p.name}</div>
            <div class="row"><span class="price">Rp ${fmt(p.price)}</span><span class="muted">Ready S-XXL</span></div>
            <div class="row">
              <button class="btn ghost" data-quick="${p.id}">👁️ Quick View</button>
              <button class="btn" data-add="${p.id}">🛒 Tambah</button>
            </div>
          </div>`
        grid.appendChild(el)
      })
    }

    // ===== Controls listeners =====
    $('#search').addEventListener('input', e=>{filters.q=e.target.value; renderProducts()})
    $('#filterCat').addEventListener('change', e=>{filters.cat=e.target.value; renderProducts()})
    $('#sort').addEventListener('change', e=>{filters.sort=e.target.value; renderProducts()})

    // ===== Cart =====
    const cartBtn = $('#cartBtn'), cartSheet = $('#cartSheet'), closeCart = $('#closeCart')
    const cartCount = $('#cartCount'), subtotalEl=$('#subtotal'), grandEl=$('#grand'), shipEl=$('#ship')

    function saveCart(){ localStorage.setItem('aj_cart', JSON.stringify(cart)); updateCartUI() }
    function updateCartUI(){
      cartCount.textContent = cart.reduce((a,b)=>a+b.qty,0)
      const container = $('#cartItems'); container.innerHTML=''
      let subtotal=0
      cart.forEach(it=>{ subtotal+=it.price*it.qty; container.appendChild(cartItemEl(it)) })
      subtotalEl.textContent = 'Rp '+fmt(subtotal)
      const ship = 20000
      shipEl.textContent = 'Rp '+fmt(ship)
      grandEl.textContent = 'Rp '+fmt(subtotal+ship)
      document.body.dataset.cart = cart.length
    }
    function cartItemEl(it){
      const el = document.createElement('div'); el.className='item'
      el.innerHTML = `
        <img src="${it.img}" alt="${it.name}">
        <div>
          <div style="font-weight:600">${it.name}</div>
          <div class="muted">Uk: ${it.size || 'M'}</div>
          <div class="muted">Rp ${fmt(it.price)} × ${it.qty}</div>
        </div>
        <div style="display:grid;gap:6px;justify-items:end">
          <div class="qty">
            <button data-dec="${it.id}">−</button>
            <span>${it.qty}</span>
            <button data-inc="${it.id}">+</button>
          </div>
          <button class="del" title="Hapus" data-del="${it.id}">🗑️</button>
        </div>`
      return el
    }

    function addToCart(id, qty=1, size='M'){
      const p = PRODUCTS.find(x=>x.id===id)
      if(!p) return
      const found = cart.find(x=>x.id===id && x.size===size)
      if(found) found.qty+=qty; else cart.push({id:p.id,name:p.name,price:p.price,img:p.img,qty, size})
      showToast('Ditambahkan ke keranjang ✅')
      saveCart()
    }

    function handleCartClick(e){
      const t = e.target
      if(t.dataset.inc){ const it = cart.find(x=>x.id==t.dataset.inc); if(it){it.qty++; saveCart()} }
      if(t.dataset.dec){ const it = cart.find(x=>x.id==t.dataset.dec); if(it){it.qty=Math.max(1,it.qty-1); saveCart()} }
      if(t.dataset.del){ const id = +t.dataset.del; cart = cart.filter(x=>x.id!==id); saveCart() }
    }

    cartBtn.addEventListener('click',()=>cartSheet.classList.add('show'))
    closeCart.addEventListener('click',()=>cartSheet.classList.remove('show'))
    $('#cartItems').addEventListener('click',handleCartClick)

    // Delegate add/quick buttons
    grid.addEventListener('click', e=>{
      const add = e.target.closest('[data-add]')
      const qv = e.target.closest('[data-quick]')
      if(add){ addToCart(+add.dataset.add) }
      if(qv){ openProductModal(+qv.dataset.quick) }
    })

    // ===== Quick View Modal =====
    const m = {
      modal: $('#productModal'), title: $('#mTitle'), img: $('#mImg'), name: $('#mName'), price: $('#mPrice'), desc: $('#mDesc'), cat: $('#mCat'), qty: $('#mQty'), size: $('#mSize'),
      add: $('#addBtn'), plus: $('#plus'), minus: $('#minus'), close: $('#mClose')
    }
    let currentId = null
    function openProductModal(id){
      const p = PRODUCTS.find(x=>x.id===id); if(!p)return
      currentId = id
      m.img.src = p.img; m.name.textContent = p.name; m.price.textContent = 'Rp '+fmt(p.price)
      m.desc.textContent = p.desc; m.cat.textContent = 'Kategori: '+p.cat.toUpperCase(); m.qty.textContent = '1'; m.size.value='M'
      m.modal.classList.add('show')
      m.modal.setAttribute('aria-hidden','false')
    }
    function closeProductModal(){ m.modal.classList.remove('show'); m.modal.setAttribute('aria-hidden','true') }
    m.close.addEventListener('click', closeProductModal)
    m.plus.addEventListener('click',()=>{m.qty.textContent = (+m.qty.textContent)+1})
    m.minus.addEventListener('click',()=>{m.qty.textContent = Math.max(1,(+m.qty.textContent)-1)})
    m.add.addEventListener('click',()=>{ addToCart(currentId, +m.qty.textContent, m.size.value); closeProductModal(); cartSheet.classList.add('show') })
    m.modal.addEventListener('click',e=>{ if(e.target===m.modal) closeProductModal() })

    // ===== Checkout =====
    const checkoutBtn = $('#checkoutBtn'), checkoutModal=$('#checkoutModal'), checkoutClose=$('#checkoutClose'), summary=$('#summary')
    checkoutBtn.addEventListener('click',()=>{
      if(cart.length===0){ return showToast('Keranjang masih kosong') }
      renderSummary(); checkoutModal.classList.add('show'); checkoutModal.setAttribute('aria-hidden','false')
    })
    checkoutClose.addEventListener('click',()=>{checkoutModal.classList.remove('show'); checkoutModal.setAttribute('aria-hidden','true')})
    checkoutModal.addEventListener('click',e=>{ if(e.target===checkoutModal) { checkoutModal.classList.remove('show'); checkoutModal.setAttribute('aria-hidden','true') } })

    function renderSummary(){
      let html=''
      let total=0
      cart.forEach(it=>{ html+=`<div class="line"><span>${it.name} (${it.size}) × ${it.qty}</span><span>Rp ${fmt(it.price*it.qty)}</span></div>`; total+=it.price*it.qty})
      html+=`<hr style="border:none;border-top:1px solid var(--line);margin:10px 0">`
      html+=`<div class="line"><strong>Subtotal</strong><strong>Rp ${fmt(total)}</strong></div>`
      summary.innerHTML = html
    }

    $('#checkoutForm').addEventListener('submit', e=>{
      e.preventDefault()
      // Simulasi sukses
      // hitung total qty terjual dan tambahkan ke sold counter
      const totalQty = cart.reduce((a,b)=>a+b.qty,0)
      incrementSold(totalQty)
      showToast('Order dibuat! Tim kami akan menghubungi via WhatsApp. ✅')
      checkoutModal.classList.remove('show'); checkoutModal.setAttribute('aria-hidden','true'); cartSheet.classList.remove('show')
      cart=[]; saveCart()
      e.target.reset()
    })

    // ===== Toast =====
    const toast = $('#toast'); let toastTimer
    function showToast(msg){
      toast.textContent = msg; toast.classList.add('show'); clearTimeout(toastTimer)
      toastTimer = setTimeout(()=>toast.classList.remove('show'), 2200)
    }

    // ===== Reveal on scroll =====
    const io = new IntersectionObserver((entries)=>{
      entries.forEach(e=>{ if(e.isIntersecting) e.target.classList.add('show') })
    }, {threshold:.15})
    $$('.reveal').forEach(el=>io.observe(el))

    // ===== Init =====
    function init(){
      renderProducts(); updateCartUI(); document.getElementById('year').textContent = new Date().getFullYear()
      incrementVisitors()
      loadCounters()
    }
    init()
  </script>
</body>
</html>
